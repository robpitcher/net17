trigger:
  branches:
    include:
    - main
  paths:
    include:
    - scripts/thing1.ps1

variables:
  buildAgentPool: 'vb6buildhost'
  repoPath: 'C:\agent\_work\1\s'
  scriptPath: 'scripts\thing1.ps1'
  
pool:
  name: $(buildAgentPool)

steps:

# - script:
#    git config --global user.email $(gitEmail) & git config --global user.name $(gitUserName)
#   workingDirectory: $(System.DefaultWorkingDirectory)
#   displayName: Set git config

- script: |
   git checkout -b main
  workingDirectory: $(repoPath)
  displayName: Checkout and pull repo

- task: PowerShell@2
  displayName: Run update revision info script
  inputs:
    targetType: filePath
    filePath: $(repoPath)\$(scriptPath)
    workingDirectory: $(repoPath)

- script: |
    git add -A
    git commit -m "update revision info [skip ci]"
    git push --set-upstream origin main
  workingDirectory: $(repoPath)
  displayName: Commit revision info output